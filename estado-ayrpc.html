<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AyRPC 2025‚Äì Estado de Cursada</title>

<script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

<style>
:root{
  --neon:#6c63ff;
  --ok:#3cff8f;
  --warn:#ffd84c;
  --bad:#ff4c4c;
  --neutral:#7a82c8;
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:system-ui,Segoe UI,Arial;
  background:#060816;
  color:#eaeaf0;
}

.container{
  padding:16px;
  max-width:1200px;
  margin:auto;
}

.card{
  background:rgba(20,25,60,.92);
  border:1px solid var(--neon);
  border-radius:14px;
  padding:16px;
  margin-bottom:16px;
}

h1,h2,h3{margin:0 0 10px}

input,button{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  font-size:16px;
}

button{
  background:var(--neon);
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}

#btnVolver{
  display:none;
  margin-bottom:12px;
  padding:6px 12px;
  font-size:13px;
  font-weight:600;
  background:rgba(20,25,60,.9);
  color:#fff;
  border:1px solid var(--neon);
  border-radius:10px;
  cursor:pointer;
  box-shadow:0 0 8px rgba(108,99,255,.4);
}


.kpis{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:12px;
}

.kpi{
  background:#0d1230;
  border-radius:12px;
  padding:12px;
  text-align:center;
}

.kpi span{
  display:block;
  font-size:22px;
  font-weight:bold;
}

.datos{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:8px;
}

@media(max-width:800px){
  .datos{grid-template-columns:1fr}
}

.tabla{
  width:100%;
  border-collapse:collapse;
}

.tabla td{
  padding:10px;
  border-bottom:1px solid rgba(255,255,255,.15);
}

.estado-ok{color:var(--ok);font-weight:bold}
.estado-bad{color:var(--bad);font-weight:bold}
.estado-neutral{color:var(--neutral);font-weight:bold}

.graficos{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
  gap:24px;
}

#debug{
  margin-top:10px;
  font-size:12px;
  color:#aaa;
  white-space:pre-wrap;
}

.cronograma a{
  color:#6c63ff;
  text-decoration:none;
}
.cronograma a:hover{
  text-decoration:underline;
}


/* ============================
   CRONOGRAMA LATERAL
============================ */

.cronograma-panel{
  position:fixed;
  top:80px;
  right:-320px;
  width:320px;
  height:auto;
  background:linear-gradient(180deg,#1a1f4d,#0c1028);
  border-left:2px solid #6c63ff;
  border-radius:12px 0 0 12px;
  box-shadow:-6px 0 20px rgba(0,0,0,.5);
  transition:.4s;
  z-index:9999;
  overflow:hidden;
}

.cronograma-panel.open{
  right:0;
}

.cronograma-header{
  background:linear-gradient(90deg,#6c63ff,#8b5cf6);
  padding:12px;
  font-weight:bold;
  color:white;
  text-align:left;
}

.cronograma-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}

#btnCronograma{
  width:auto;
  padding:6px 10px;
  font-size:12px;
  border-radius:8px;
  border:none;
  background:#ffffff;
  color:#3b36ff;
  cursor:pointer;
  font-weight:800;
}

#btnCronograma:hover{
  background:#e9e9ff;
}


.cronograma-header small{
  display:block;
  font-size:11px;
  opacity:.8;
}

.cronograma-body{
  padding:12px;
  font-size:14px;
}

.cronograma-body h4{
  margin:10px 0 6px;
  color:#9fa8ff;
}

.clase{
  background:rgba(255,255,255,.06);
  padding:8px;
  border-radius:8px;
  margin-bottom:6px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.clase.done{
  border-left:4px solid #3cff8f;
}

.clase.future{
  border-left:4px solid #7a82c8;
  opacity:.9;
}

.clase.last{
  border-left:4px solid #ff4c4c;
}

.btn-ver{
  background:#2bdc8c;
  color:#000;
  padding:4px 8px;
  border-radius:6px;
  font-size:12px;
  text-decoration:none;
  font-weight:bold;
}

.btn-ver:hover{
  background:#3cffaa;
}

  
.loader{
  width:32px;
  height:32px;
  border:4px solid rgba(255,255,255,.2);
  border-top:4px solid var(--neon);
  border-radius:50%;
  animation: spin 1s linear infinite;
  margin:auto;
}

@keyframes spin{
  to{ transform: rotate(360deg); }
}

#btnAbrirCronograma{
  width:auto;
  position:fixed;
  bottom:20px;
  right:20px;
  background:#6c63ff;
  color:white;
  border:none;
  border-radius:12px;
  padding:10px 14px;
  font-weight:bold;
  cursor:pointer;
  z-index:9000;
  box-shadow:0 0 15px rgba(0,0,0,.4);
}

#btnAbrirCronograma:hover{
  background:#7c74ff;
}

/* ============================
   PANEL CONTACTO (NUEVO)
============================ */

.contacto-panel{
  position:fixed;
  top:80px;
  right:-280px;
  width:280px;
  background:linear-gradient(180deg,#1a1f4d,#0c1028);
  border-left:2px solid var(--neon);
  border-radius:12px 0 0 12px;
  padding:12px;
  box-shadow:-6px 0 20px rgba(0,0,0,.5);
  transition:.4s;
  z-index:9999;
}

.contacto-panel.open{
  right:20px;
}

.contacto-grid{
  display:flex;
  flex-direction:column;
  gap:14px;
}

/* Bot√≥n/icono */
.contacto-item{
  display:flex;
  align-items:center;
  gap:12px;
  background:#2b2f66;
  padding:10px;
  border-radius:12px;
  cursor:pointer;
  transition:.25s;
  overflow:hidden;
}

.contacto-item:hover{
  background:#3b40a0;
  transform:scale(1.03);
}

/* icono */
.contacto-item img{
  width:40px;
  height:40px;
  border-radius:50%;
  object-fit:cover;
  box-shadow:
    0 0 6px rgba(108,99,255,.8),
    0 0 14px rgba(108,99,255,.5);
}

/* texto oculto */
.contacto-texto{
  white-space:nowrap;
  opacity:0;
  transform:translateX(-10px);
  transition:.25s;
  font-weight:600;
  color:#fff;
}

/* aparece al hover */
.contacto-item:hover .contacto-texto{
  opacity:1;
  transform:translateX(0);
}

/* bot√≥n flotante */

#btnAbrirContacto{
  position:fixed;
  bottom:72px;
  right:20px;
  background:#6c63ff;
  color:white;
  border:none;
  border-radius:12px;
  padding:10px 14px;
  font-weight:bold;
  cursor:pointer;
  z-index:9001;
  box-shadow:0 0 15px rgba(0,0,0,.4);
  transition:.25s;
}

#btnAbrirContacto:hover{
  background:#7c74ff;
}


/* Evita que el bot√≥n herede width:100% */
#btnAbrirContacto{
  width:auto !important;
}

  
</style>
</head>

<body>

<button id="btnVolver">‚Üê Volver</button>

<div class="container">

<h1>‚ö° AyRPC ‚Äì Estado de cursada</h1>

<div class="card" id="login">
  <h2>Ingres√° tu DNI</h2>
  <input id="dniInput" type="number" placeholder="DNI sin puntos">
  <button id="btnBuscar">Ver mi estado</button>

  <div id="errorBox" style="display:none; margin-top:10px; color:#ff4c4c; font-weight:600;">
    ‚ùå DOCUMENTO INV√ÅLIDO<br>
    Introduzca el mismo con el que se inscribi√≥, sin puntos ni espacios.
  </div>

  <div id="loadingBox" style="display:none; margin:20px 0; text-align:center;">
    <div class="loader"></div>
    <div style="margin-top:8px; color:#aaa;">Consultando estado acad√©mico...</div>
  </div>
  
  <div id="debug"></div>
</div>

<div id="contenido" style="display:none">

<div class="card">
  <h2 id="nombre"></h2>
  <div class="kpis">
    <div class="kpi">Asistencia<span id="k-asistencia"></span></div>
    <div class="kpi">%<span id="k-porcentaje"></span></div>
    <div class="kpi">Estado<span id="k-estado"></span></div>
  </div>
</div>

<div class="card">
  <h3>Datos</h3>
  <div class="datos">
    <div><b>Correo:</b> <span id="d-correo"></span></div>
    <div><b>Tel√©fono:</b> <span id="d-telefono"></span></div>
    <div><b>Twitch:</b> <span id="d-twitch"></span></div>
    <div><b>Observaciones:</b> <span id="d-obs"></span></div>
  </div>
</div>

<div class="card">
  <h3>Clases</h3>
  <table class="tabla">
    <tbody id="tablaClases"></tbody>
  </table>
</div>

<div class="card">
  <h3>Gr√°ficos</h3>
  <div id="graficos" class="graficos"></div>
</div>

</div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbwkePWjJYOgtwNbrfzFW7bA_jwcJd-p1VflvYs087BC3zGKta0WsdDEsqstj7nUEUWC/exec";

const ORDEN = [
 {n:"Primera Clase",k:"1er"},
 {n:"Segunda Clase",k:"2da"},
 {n:"Tercera Clase",k:"3er"},
 {n:"Cuarta Clase",k:"4ta"},
 {n:"Quinta Clase",k:"5ta"},
 {n:"Sexta Clase",k:"6ta"},
 {n:"√öltima Clase",k:"Ultima"}
];

const CFG={
 "1er":{total:11400,min:8550},
 "2da":{total:6800,min:5100},
 "3er":{total:7600,min:5700},
 "4ta":{total:7600,min:5700},
};

const login = document.getElementById("login");
const contenido = document.getElementById("contenido");
const btnVolver = document.getElementById("btnVolver");
const debug = document.getElementById("debug");

const nombre = document.getElementById("nombre");
const dCorreo = document.getElementById("d-correo");
const dTelefono = document.getElementById("d-telefono");
const dTwitch = document.getElementById("d-twitch");
const dObs = document.getElementById("d-obs");

const tablaClases = document.getElementById("tablaClases");
const graficos = document.getElementById("graficos");

const kAsistencia = document.getElementById("k-asistencia");
const kPorcentaje = document.getElementById("k-porcentaje");
const kEstado = document.getElementById("k-estado");

const TOTAL_EVALUADAS = 4;

document.getElementById("btnBuscar").onclick = cargar;
btnVolver.onclick = volver;

function log(m){ debug.textContent += m+"\n"; }

async function cargar(){
  const dni = document.getElementById("dniInput").value.trim();

  if(!dni){
    alert("Ingres√° un DNI");
    return;
  }

  // reset visual
  document.getElementById("errorBox").style.display = "none";
  document.getElementById("loadingBox").style.display = "block";
  contenido.style.display = "none";

  try{
    const r = await fetch(API + "?dni=" + encodeURIComponent(dni));
    const data = await r.json();

    document.getElementById("loadingBox").style.display = "none";

    // üëâ SI NO EXISTE EL DNI
    if(!data || !data["Nombre Completo"]){
      document.getElementById("errorBox").style.display = "block";
      return;
    }

    procesar(data);

  }catch(e){
    document.getElementById("loadingBox").style.display = "none";
    document.getElementById("errorBox").style.display = "block";
  }
}


function procesar(a){
  login.style.display="none";
  contenido.style.display="block";
  btnVolver.style.display="block";

  nombre.textContent = a["Nombre Completo"];
  dCorreo.textContent = a["Correo"];
  dTelefono.textContent = a["Tel√©fono (con C√≥digo de √Årea)"];
  dTwitch.textContent = a["Usuario de Twitch (en caso de no tener, deber√° crear uno y usarlo en la cursada)"];
  dObs.textContent = a["Observaciones"];

  tablaClases.innerHTML="";
  graficos.innerHTML="";

  let ok=0;

  ORDEN.forEach((c,i)=>{
    const est=(a[c.k+"Clase ‚Äì Presente"]||"-").toUpperCase();
    const tiempo=a[c.k+"Clase ‚Äì Tiempo"]||"-";

    let cls="estado-neutral";
    if(est==="PRESENTE"||est==="RECUPERADA") cls="estado-ok";
    if(est==="AUSENTE") cls="estado-bad";

    tablaClases.innerHTML+=`
      <tr>
        <td>${c.n}</td>
        <td class="${cls}">${est}</td>
        <td>${tiempo}</td>
        <td>${i < TOTAL_EVALUADAS ? "Evaluada" : "Pendiente"}</td>
      </tr>
    `;

    if(i < TOTAL_EVALUADAS && (est==="PRESENTE" || est==="RECUPERADA")) ok++;

    if(CFG[c.k]){
      const div=document.createElement("div");
      graficos.appendChild(div);
      grafico(div,c,tiempo);
    }
  });

  kAsistencia.textContent = ok + "/" + TOTAL_EVALUADAS;
kPorcentaje.textContent = Math.round(ok / TOTAL_EVALUADAS * 100) + "%";

kEstado.textContent =
  ok === TOTAL_EVALUADAS ? "EXCELENTE" :
  ok === TOTAL_EVALUADAS - 1 ? "DEBE 1 CLASE" :
  ok === TOTAL_EVALUADAS - 2 ? "DEBE 2 CLASES" :
  "RIESGO";
}

function parseT(t){
  if(!t) return 0;
  const h=/(\d+)h/.exec(t);
  const m=/(\d+)m/.exec(t);
  const s=/(\d+)s/.exec(t);
  return (h?+h[1]:0)*3600+(m?+m[1]:0)*60+(s?+s[1]:0);
}

function grafico(el,c,t){
  const seg=parseT(t);
  Plotly.newPlot(el,[{
    type:"bar",
    orientation:"h",
    x:[Math.round(seg/60)],
    y:[""],
    marker:{color:seg>=CFG[c.k].min?"#3cff8f":"#ff4c4c"}
  }],{
    xaxis:{range:[0,Math.round(CFG[c.k].total/60)]},
    height:120,
    margin:{l:20,r:20,t:30,b:20},
    paper_bgcolor:"transparent",
    plot_bgcolor:"transparent"
  },{displayModeBar:false});
}

function volver(){
  contenido.style.display="none";
  login.style.display="block";
  btnVolver.style.display="none";
}

function toggleCronograma(){
  const panel = document.getElementById("cronogramaPanel");
  const btnFloating = document.getElementById("btnAbrirCronograma");
  const btnInside = document.getElementById("btnCronograma");

  panel.classList.toggle("open");

  const abierto = panel.classList.contains("open");

  if(btnFloating) btnFloating.style.display = abierto ? "none" : "block";
  if(btnInside) btnInside.textContent = abierto ? "X" : "X";
}

function toggleContacto(){
  const panel = document.getElementById("panelContacto");
  const btn = document.getElementById("btnAbrirContacto");
  const cronograma = document.getElementById("cronogramaPanel");

  const abierto = panel.classList.toggle("open");

  // ocultar bot√≥n cuando est√° abierto
  btn.style.display = abierto ? "none" : "flex";

  // cerrar cronograma si estaba abierto
  cronograma.classList.remove("open");
}


document.addEventListener("click", (e)=>{
  const panel = document.getElementById("panelContacto");
  const btn = document.getElementById("btnAbrirContacto");

  if(!panel.classList.contains("open")) return;
  if(panel.contains(e.target) || btn.contains(e.target)) return;

  panel.classList.remove("open");
  btn.style.display = "flex";
});

</script>


<!-- CRONOGRAMA LATERAL -->
<div id="cronogramaPanel" class="cronograma-panel">

  <div class="cronograma-header">
    <div class="cronograma-top">
      <span>üìÖ Cronograma y Temario</span>
      <button id="btnCronograma" type="button" onclick="toggleCronograma()">X</button>
    </div>
    <small>Siempre a las 19:30 hs</small>
  </div>


  <div class="cronograma-body">

    <h4>Clases dictadas (recuperables)</h4>

    <div class="clase done">
      <span>üß© 29/11/2025 ‚Äì Armado y Componentes</span>
      <a href="https://www.twitch.tv/videos/2631557465" target="_blank" class="btn-ver">Ver grabaci√≥n</a>
    </div>

    <div class="clase done">
      <span>üíø 13/12/2025 ‚Äì Instalaci√≥n de SO y Drivers</span>
      <a href="https://www.twitch.tv/videos/2643299509" target="_blank" class="btn-ver">Ver grabaci√≥n</a>
    </div>

    <div class="clase done">
      <span>‚öôÔ∏è 20/12/2025 ‚Äì Programaci√≥n de BIOS</span>
      <a href="https://www.twitch.tv/videos/2649204620" target="_blank" class="btn-ver">Ver grabaci√≥n</a>
    </div>

    <div class="clase done">
      <span>üß† 03/01/2026 ‚Äì Software y Herramientas</span>
      <a href="https://www.twitch.tv/videos/2661787837" target="_blank" class="btn-ver">Ver grabaci√≥n</a>
    </div>

    <hr>

    <h4>Clases restantes</h4>

    <div class="clase future">üß∑ 10/01/2026 ‚Äì Microsoldaduras</div>
    <div class="clase future">üßØ 17/01/2026 ‚Äì Soluci√≥n de Problemas</div>
    <div class="clase future last">ü¶† 24/01/2026 ‚Äì Virus y Malware (√öltima)</div>

  </div>
</div>

<button id="btnAbrirCronograma" onclick="toggleCronograma()">
  üìÖ Cronograma y temario
</button>

<button id="btnAbrirContacto" onclick="toggleContacto()">
  üíå Contacto
</button>


<div id="panelContacto" class="contacto-panel">
  <div class="contacto-grid">

    <a class="contacto-item" href="https://wa.me/5492236689580" target="_blank">
      <img src="icons/whatsapp.png">
      <span class="contacto-texto">Contactar al Profe (WhatsApp)</span>
    </a>

    <a class="contacto-item" href="mailto:acoria@frba.utn.edu.ar">
      <img src="icons/mail.png">
      <span class="contacto-texto">Contactar al Profe (Mail)</span>
    </a>

    <a class="contacto-item" href="https://chat.whatsapp.com/LczmlYvVzWf2SDStqVMUqW" target="_blank">
      <img src="icons/comunidad.png">
      <span class="contacto-texto">Comunidad AyRPC</span>
    </a>

  </div>
</div>
  
</body>
</html>








